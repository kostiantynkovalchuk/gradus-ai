# Add "–•—Ç–æ —Ç–∏?" Preset to Production Database

## OBJECTIVE
Insert the "–•—Ç–æ —Ç–∏?" (Who are you?) preset into the PRODUCTION Neon database (not local Replit database).

## CONTEXT
The preset was previously added to Replit's local database, but production (Render) uses a separate Neon database. The production database is missing this preset, which is why it's not working in production.

## TASK

Connect to the production PostgreSQL database using the `DATABASE_URL` environment variable and insert the preset.

### SQL to Execute:
```sql
INSERT INTO hr_preset_answers (
    question,
    answer,
    category,
    search_patterns,
    priority,
    usage_count,
    created_at,
    updated_at
) VALUES (
    '–•—Ç–æ —Ç–∏?',
    '–ü—Ä–∏–≤—ñ—Ç! –Ø Maya ‚Äî —Ç–≤—ñ–π HR-–∞—Å–∏—Å—Ç–µ–Ω—Ç —É –¢–æ—Ä–≥–æ–≤–æ–º—É –î–æ–º—ñ –ê–í! üíÉ

–†–∞–¥–∞ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ç–æ–±—ñ –∑:
- –í—ñ–¥–ø—É—Å—Ç–∫–∞–º–∏ —Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç–æ—é üí∞
- –¢–µ—Ö–ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é (–ë–ª—ñ—Ü, –£–†–°, –¥–æ—Å—Ç—É–ø–∏) üîß
- –î–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏ üìã
- –ö–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç—ñ–≤ üìû

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–≤–æ—î –ø–∏—Ç–∞–Ω–Ω—è, —ñ —è –∑ —Ä–∞–¥—ñ—Å—Ç—é –¥–æ–ø–æ–º–æ–∂—É! üí¨',
    'general',
    '—Ö—Ç–æ —Ç–∏|who are you|–ø—Ä–µ–¥—Å—Ç–∞–≤—Å—è|—Ä–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —Å–µ–±–µ|–ø—Ä–æ —Ç–µ–±–µ|—â–æ —Ç–∏ –≤–º—ñ—î—à|what can you do|–º–∞–π—è —Ö—Ç–æ —Ç–∏',
    10,
    0,
    NOW(),
    NOW()
)
ON CONFLICT (question) DO UPDATE 
SET answer = EXCLUDED.answer,
    search_patterns = EXCLUDED.search_patterns,
    updated_at = NOW();
```

### Python Implementation:
```python
import os
import psycopg2

# Get production database URL
database_url = os.getenv("DATABASE_URL")

if not database_url:
    print("ERROR: DATABASE_URL not found in environment variables")
    exit(1)

# Connect to production database
conn = psycopg2.connect(database_url)
cursor = conn.cursor()

# Insert preset
preset_sql = """
INSERT INTO hr_preset_answers (
    question,
    answer,
    category,
    search_patterns,
    priority,
    usage_count,
    created_at,
    updated_at
) VALUES (
    %s, %s, %s, %s, %s, %s, NOW(), NOW()
)
ON CONFLICT (question) DO UPDATE 
SET answer = EXCLUDED.answer,
    search_patterns = EXCLUDED.search_patterns,
    updated_at = NOW()
RETURNING id;
"""

question = '–•—Ç–æ —Ç–∏?'
answer = '''–ü—Ä–∏–≤—ñ—Ç! –Ø Maya ‚Äî —Ç–≤—ñ–π HR-–∞—Å–∏—Å—Ç–µ–Ω—Ç —É –¢–æ—Ä–≥–æ–≤–æ–º—É –î–æ–º—ñ –ê–í! üíÉ

–†–∞–¥–∞ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ç–æ–±—ñ –∑:
- –í—ñ–¥–ø—É—Å—Ç–∫–∞–º–∏ —Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç–æ—é üí∞
- –¢–µ—Ö–ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é (–ë–ª—ñ—Ü, –£–†–°, –¥–æ—Å—Ç—É–ø–∏) üîß
- –î–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏ üìã
- –ö–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç—ñ–≤ üìû

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–≤–æ—î –ø–∏—Ç–∞–Ω–Ω—è, —ñ —è –∑ —Ä–∞–¥—ñ—Å—Ç—é –¥–æ–ø–æ–º–æ–∂—É! üí¨'''
category = 'general'
search_patterns = '—Ö—Ç–æ —Ç–∏|who are you|–ø—Ä–µ–¥—Å—Ç–∞–≤—Å—è|—Ä–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —Å–µ–±–µ|–ø—Ä–æ —Ç–µ–±–µ|—â–æ —Ç–∏ –≤–º—ñ—î—à|what can you do|–º–∞–π—è —Ö—Ç–æ —Ç–∏'
priority = 10
usage_count = 0

cursor.execute(preset_sql, (question, answer, category, search_patterns, priority, usage_count))
preset_id = cursor.fetchone()[0]

conn.commit()

print(f"‚úÖ Preset added/updated successfully!")
print(f"   ID: {preset_id}")
print(f"   Question: {question}")
print(f"   Category: {category}")
print(f"   Patterns: {search_patterns}")

# Verify it was inserted
cursor.execute("SELECT COUNT(*) FROM hr_preset_answers WHERE question = %s", (question,))
count = cursor.fetchone()[0]
print(f"   Verification: {count} preset(s) found with this question")

cursor.close()
conn.close()
```

## VERIFICATION

After inserting, verify the preset exists in production:
```python
# Count total presets
cursor.execute("SELECT COUNT(*) FROM hr_preset_answers WHERE is_active = true")
total = cursor.fetchone()[0]
print(f"Total active presets in production: {total}")

# Show the new preset
cursor.execute("SELECT id, question, category FROM hr_preset_answers WHERE question = '–•—Ç–æ —Ç–∏?'")
result = cursor.fetchone()
if result:
    print(f"Found preset: ID={result[0]}, Question={result[1]}, Category={result[2]}")
```

## IMPORTANT NOTES

1. **Use DATABASE_URL from environment** - This points to production Neon database
2. **ON CONFLICT** clause - Updates if preset already exists (idempotent)
3. **After insertion** - Backend needs restart to reload cache (or wait for next query if cache auto-refreshes)

## SUCCESS CRITERIA

‚úÖ Script connects to production database successfully
‚úÖ Preset inserted/updated without errors
‚úÖ Verification query shows preset exists
‚úÖ Total preset count increases (or stays same if updating existing)

## NEXT STEPS

After running this script:
1. Restart Render backend to reload preset cache
2. Test in production Telegram: Send "–•—Ç–æ —Ç–∏?" to Maya
3. Should see instant response (~75ms) with correct introduction
4. Logs should show: `‚úÖ PRESET HIT` instead of `‚ùå NO PRESET`